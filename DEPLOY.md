# Деплой на Space Web через GitHub Actions

Файлы заливаются в **public_html** по **FTP** (порт 21). Обновление: правки в Cursor → **git push** → через 1–2 минуты сайт обновлён.

Раньше использовался SFTP — на этом хостинге он падал с ошибкой «Multiple paths match...», поэтому деплой переведён на FTP.

---

## Один раз: секрет в GitHub

1. Репозиторий на github.com → **Settings** → **Secrets and variables** → **Actions**.
2. **New repository secret**: Name = `SFTP_PASSWORD`, Value = пароль от аккаунта Space Web (логин infogkmeta). Тот же секрет используется для FTP.

---

## ЧТО СДЕЛАТЬ В ПАНЕЛИ (один раз после первого деплоя)

1. Панель Space Web → **Хостинг** → **Сайты** (или настройки домена).
2. Найти поле **«Корневая папка»** / **«Document root»** / **«Каталог сайта»**.
3. Указать: **public_html/public** (или полный путь: `/home/infogkmeta/public_html/public`).
4. Сохранить.

Без этого откроется не тот каталог и сайт не заработает.

**Если сайт пишет ошибку про базу данных:** скопировать с локального ПК файл `storage/database.sqlite` в папку **public_html/storage/** на сервере (через файловый менеджер панели). Либо один раз локально выполнить `php storage/seed.php`, потом залить получившийся `storage/database.sqlite` в **public_html/storage/**.

---

## Как деплоить дальше

В Cursor: правки → в терминале `git add .` → `git commit -m "..."` → `git push`. Статус смотреть во вкладке **Actions** на GitHub.

---

## Если деплой падает

- **Permission denied** / **Login incorrect** — проверить секрет `SFTP_PASSWORD` (пароль без пробелов). Убедиться, что FTP включён в панели Space Web и логин/пароль совпадают с панелью.
- **No such file** — папка `public_html` должна существовать (обычно есть по умолчанию).
- Если хостинг даёт отдельный FTP-хост (например, `ftp.ваш-домен.ru`) — в `.github/workflows/deploy.yml` в шаге «Deploy via FTP» заменить `server: 77.222.40.49` на этот хост.
- Логи: GitHub → **Actions** → последний запуск → шаг «Deploy via FTP».

---

## Вариант Б: Git на сервере (если есть полноценный SSH)

Если при подключении по SSH у тебя **есть оболочка** (приглашение вроде `infogkmeta@server:~$` и команды выполняются), можно обновлять сайт через `git pull` на сервере. Инструкция от Space Web:

1. Подключись по SSH: `ssh infogkmeta@77.222.40.49 -p 22`
2. Перейди в папку сайта, например: `cd ~/public_html` (или ту, где лежит сайт)
3. Один раз клонировать репозиторий:  
   `git clone git@github.com:твой_логин/lenta-nerzhavejushhaja-aisi.git .`  
   (точка в конце — файлы в текущую папку)
4. Чтобы GitHub не спрашивал пароль, на сервере создай SSH-ключ и добавь его в GitHub:
   - На сервере: `ssh-keygen -t rsa` (на вопросы — Enter)
   - Показать ключ: `cat ~/.ssh/id_rsa.pub`
   - В GitHub: **Settings** → **SSH and GPG keys** → **New SSH key** → вставить ключ
   - Проверка: `ssh -T git@github.com`
5. Дальше для обновления: зайти по SSH, перейти в папку сайта и выполнить `git pull`

**Если при SSH сессия сразу закрывается** (нет приглашения и нельзя вводить команды) — тогда инструкция поддержки (git clone / git pull) невыполнима. См. блок ниже.

---

## Что написать в поддержку Space Web

Если тебе прислали инструкцию «подключиться по SSH и выполнить git clone / git pull», но при подключении по SSH сессия сразу обрывается (Connection closed), можно ответить так:

«При подключении по SSH (логин infogkmeta, порт 22) после ввода пароля сессия сразу закрывается (Connection closed), интерактивной оболочки нет — команды cd, git clone, git pull выполнить невозможно. Подскажите, пожалуйста: 1) как получить полноценный SSH (shell) для этого аккаунта, или 2) есть ли в панели «Терминал» / «SSH-консоль» для выполнения команд, или 3) поддерживается ли автоматический деплой из GitHub (webhook, встроенная интеграция)? Деплой через GitHub Actions по SFTP на этот хостинг падает с ошибкой «Multiple paths match, but destination ... is not a directory» при любой целевой папке.»

Скопируй и вставь в обращение в поддержку (можно сократить). Ответ поддержки подскажет, есть ли у них нормальный shell или другой способ деплоя из GitHub.
